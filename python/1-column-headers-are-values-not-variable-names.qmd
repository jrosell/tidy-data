---
title: "1-column-headers-are-values-not-variable-names.qmd"
format:
  html:
    code-fold: true
jupyter: python3
tbl-colwidths: 100
---

```{python}
import pandas as pd
import datetime
from os import listdir
from os.path import isfile, join
import glob
import re
df = pd.read_csv("../data/pew-raw.csv")
print("\nOriginal pew-raw.csv data")
pd.set_option('display.width', 1000)
print(df.head(10))
print("\nProblem:\nThe columns headers are composed of the possible income values.")
```

```{python}
formatted_df = pd.melt(
    df,
    ["religion"],
    var_name="income",
    value_name="freq"
)
formatted_df = formatted_df.sort_values(by=["religion"])

print("\nSolution:\nA tidy version of this dataset is a longer one in which the income values would not be columns headers but rather values in an income column.\n")
print(formatted_df.head(10))
```